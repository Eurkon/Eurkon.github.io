var fdata={api:"https://friends.eurkon.com/",init:20,step:10,show:8,sort:"created",avatar:"https://npm.elemecdn.com/eurkon-cdn/hexo/images/user/loading.gif"};function loadArticleItem(e,t,a,n){let i="";for(let l=t;l<Math.min(a,n);l++){let t=e[l];i+=`\n      <div class="fc-banner-item">\n        <a href="${t.link}" title="${t.author}"> \n          <img class="fc-banner-img" src="${t.avatar}" alt="${t.title}" no-lightbox onerror="this.onerror=null;this.src='${fdata.avatar}';">\n        </a>\n        <div class="fc-banner-content">\n          <a class="fc-banner-title" href="${t.link}" target="_blank" rel="noopener nofollow" title="${t.title}">${t.title}</a>\n          <span class="fc-banner-created" style="${"created"==fdata.sort?"":"display:none"}">${t.created}</span>\n          <span class="fc-banner-updated" style="${"updated"==fdata.sort?"":"display:none"}">${t.updated}</span>\n        </div>\n      </div>\n      `}document.getElementById("fc-banner").insertAdjacentHTML("beforeend",i),document.body.insertAdjacentHTML("afterend",'<div id="fc-overlay" class="hidden" onclick="closeShow()"></div>\n  <div id="fc-overshow-parent"><div id="fc-overshow" class="hidden"></div></div>'),window.Lately&&Lately.init({target:".fc-banner-"+fdata.sort})}function fetchFriendCircle(e){let t=fdata.api+"all?rule="+e+"&start=0&end="+fdata.init;fetch(t).then((e=>e.json())).then((e=>{let t=e.statistical_data,a=e.article_data;localStorage.setItem("fc_statistical",JSON.stringify(t)),localStorage.setItem("fc_article",JSON.stringify(a)),loadArticleItem(a,0,fdata.init,t.article_num)}))}function loadFcircleShow(e,t){let a='<div class="fc-overshow" style="display: flex; align-items: center; justify-content: center;">暂无数据</div>';if(e&&t){a=`\n      <div class="fc-overshow">\n        <div class="fc-overshow-head avatar-img">\n          <a target="_blank" rel="noopener nofollow" href="${e.link}"><img src="${e.avatar}" alt="avatar" onerror="this.src='${fdata.avatar}'; this.onerror = null;"></a>\n        </div>\n        <div>\n          <i class="far fa-user"></i>\n          <span class="fc-article-author">${e.name}</span>\n        </div>\n        <div class="fc-overshow-content">`;for(let n=0;n<Math.min(e.article_num,fdata.show);n++){let e=t[n];a+=`\n      <p><a class="article-sort-item-title" href="${e.link}" target="_blank" rel="noopener nofollow" title="${e.title}">${e.title}</a><span>${e.created}</span></p>`}a+="</div></div>"}document.getElementById("fc-overshow").insertAdjacentHTML("beforeend",a)}function openMeShow(e){e.preventDefault();let t=e.currentTarget.dataset.link.replace(/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/,"$1:$2$3"),a="";a=fdata.api+"post?link="+t+"&num=10",fetchShow(a)}function closeShow(){document.getElementById("fc-overlay").classList.add("hidden"),document.getElementById("fc-overshow").classList.add("hidden"),document.getElementById("fc-overshow").innerHTML=""}function fetchShow(e){document.getElementById("fc-overlay").classList.remove("hidden"),document.getElementById("fc-overshow").insertAdjacentHTML("afterbegin",'<div class="fc-overshow-close" onclick="closeShow()"></div>'),document.getElementById("fc-overshow").classList.remove("hidden"),document.getElementById("fc-overshow").insertAdjacentHTML("beforeend",'<div class="fc-overshow"><i class="fa fas fa-spinner fa-spin" style="font-size: 5rem; line-height: 20rem;"></i></div>'),fetch(e).then((e=>e.json())).then((e=>{loadFcircleShow(e.statistical_data,e.article_data)})).catch((function(e){loadFcircleShow()}))}function initFriendCircle(e){let t=document.getElementById("fc-banner"),a=JSON.parse(localStorage.getItem("fc_statistical")),n=JSON.parse(localStorage.getItem("fc_article"));if(a&&n){loadArticleItem(n,0,fdata.init,a.article_num);let i=fdata.api+"all?rule="+e+"&start=0&end="+fdata.init;fetch(i).then((e=>e.json())).then((e=>{let i=e.statistical_data,l=e.article_data;a.article_num===i.article_num&&n[0].title===l[0].title||(t.innerHTML="",localStorage.setItem("fc_statistical",JSON.stringify(i)),localStorage.setItem("fc_article",JSON.stringify(l)),loadArticleItem(l,0,fdata.init,i.article_num))}))}else fetchFriendCircle(fdata.sort)}initFriendCircle(fdata.sort);